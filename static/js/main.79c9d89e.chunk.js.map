{"version":3,"sources":["User.js","MatrixList.js","Editable.js","KoreanVK.js","JapaneseVK.js","VirtualKeyboardInput.js","Matrix.js","NavBar.js","TestPage.js","App.js","serviceWorker.js","index.js"],"names":["localStorage","window","getAllLocalData","Data","concat","Topik1","Coca","JapaneseWords","KorBooks","getProperty","entity","id","propertyName","path","getItem","LocalUser","setTimeout","name","undefined","password","rememberMe","console","log","setItem","removeItem","email","map","item","index","Id","Name","description","Description","language","Language","row_number","Rows","length","fromRow","number","data","deckData","find","deck","rowsWithId","wordId","transScore","word","meaning","extra","score","Math","floor","rows","LocalDeck","deckId","translation","LocalTest","succeeded","setScore","scoreName","prevScore","newScore","trunc","getScoreAfterTest","value","setProperty","user","test","getUser","getTest","MatrixList","props","state","decks","getDeckList","this","setState","key","to","className","React","Component","Editable","text","type","placeholder","children","childRef","useState","isEditing","setEditing","useEffect","current","focus","onBlur","onKeyDown","e","event","keys","allKeys","indexOf","handleKeyDown","onClick","code_holder","release_selection","input","replace_selection","str","highlight","initial_table","medial_table","final_table","jaso_table","compose_korean_char","alphabet","i","String","fromCharCode","charCodeAt","shift","final_code","medial_code","initial_code","charAt","j","k","tmp","key_down_korean","input_ctrl","substring","clear_all","shiftKey","key_down","which","keyCode","left_yinhao1","left_yinhao2","Callback","word_lists","splits","page_number","list_index","show_hiragana","words_in_list","$","menu","eq","substr","alert","hide_popup","remove","populateMenu","highlight_word","fetch","method","cors","referrerPolicy","headers","then","response","matchAll","words","split","w","push","match","createMenu","removeClass","addClass","all","prev_page","next_page","startWordIndex","endWordIndex","min","pageUp","css","append","itemText","link","click","pageDn","after","createPopper","placement","key_char_quan","romaji_array","alphabet_to_kana","char","show_katakana","head_str","rear_str","kana","find_hiragana","check_romaji","show","key_down_japanese","callback","is_word_div_visible","p2","show_popup","insert_word","get_word_div_visible","ctrlKey","VirtualKeyboardInput","inputDiv","createRef","vkEdit","VirtuakKeyboardEdit","input_text","ethalon","onChange","style","minWidth","display","contentEditable","ref","bind","handleMouseDown","handleOnInput","keydown","mousedown","on","activeNode","afterNode","key_down_handler","key_down_native","show_hint","inEdit","ret_value","blur","document","button","getSelection","sel","focusNode","focusOffset","newPos","setCaretPosition","stopElem","contents","each","elem","textContent","getActiveNodeAndOffset","focusedNode","textOffset","text_before_caret","get_text_before","text_before","get_text_before_caret","hint","hintElem","append_elem_after_caret","after_elem","full_text","correct_text","newNode","createTextNode","nodeType","Node","TEXT_NODE","firstChild","get_input_text","after_node","new_elem","parentNode","node","nodeValue","setActiveNodeCaretPos","added_text","finish_input","initialText","newSpan","after_text","selected_text","caretPos","range","createRange","setStart","collapse","removeAllRanges","addRange","InputEditable","typedText","setTypedText","Mode","Object","freeze","ShowWordAndTranslation","TestTranslation","TestWord","ConfirmTranslationControls","Step","ShowOkFailed","Ok","Failed","step","setStep","Fragment","setTranslationTestResult","repeat","getWordToShow","isKanaMode","ShowBothMode","modeControls","isFirst","wordToShow","rowSpan","TestTranslationMode","isTranslationShown","showTranslation","TranslationCell","buttonShow","disabled","bgColor","getBgColorFromScore","backgroundColor","RowToInputWord","isCorrect","setCorrect","editable","correct","TestWordMode","Card","isActive","onActivate","initialMode","onResetMode","mode","setMode","ModeButton","buttonMode","title","autoComplete","checked","modeTable","args","data-toggle","KanaMode","target","htmlFor","VirtualKbd","defaultChecked","OnlyForgotten","getCountryFlag","cc","risl","chr","fromCodePoint","toUpperCase","Emoji","role","aria-label","label","aria-hidden","symbol","LanguageSelector","width","SetAllCardMode","onModeChange","Matrix","setDeck","activeCardId","setActiveCardId","setKanaMode","isOnlyForgottenWords","setOnlyForgottenWords","setInitialMode","deckGetter","urlParams","queryString","parse","location","search","a","getDeck","deckD","cardRows","filter","cards","size","temparray","slice","cardData","isSet","UserControl","username","setUsername","history","useHistory","userGetter","getName","Login","Button","variant","logout","setShow","setPassword","setRememberMe","handleClose","Modal","onHide","Header","closeButton","Title","Body","Form","Group","controlId","Control","Check","Footer","login","NavBar","src","alt","height","InputTest","TestPage","Error","App","component","exact","Boolean","hostname","ReactDOM","render","StrictMode","getElementById","navigator","serviceWorker","ready","registration","unregister","catch","error","message"],"mappings":"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AM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,SAAK,UACb,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,eAAM,gBACb,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,eAAM,gBACb,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,eAAM,gBACb,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,eAAM,gBACb,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,SAAK,UACb,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,SAAK,UACb,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,SAAK,UACb,CAAC,qBAAO,SAAK,UACb,CAAC,2BAAQ,SAAK,UACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,eAAM,gBACb,CAAC,eAAM,eAAM,gBACb,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,eAAM,gBACb,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,eAAM,gBACb,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,eAAM,gBACb,CAAC,eAAM,eAAM,gBACb,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,eAAM,gBACb,CAAC,eAAM,eAAM,gBACb,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,SAAK,UACb,CAAC,qBAAO,SAAK,UACb,CAAC,qBAAO,SAAK,UACb,CAAC,qBAAO,SAAK,UACb,CAAC,qBAAO,SAAK,UACb,CAAC,qBAAO,SAAK,UACb,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,UACZ,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,qBAAO,eAAM,gBACd,CAAC,eAAM,SAAK,UACZ,CAAC,eAAM,SAAK,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","file":"static/js/main.79c9d89e.chunk.js","sourcesContent":["import Data from './deck/Data.json';\r\nimport Coca from './deck/Coca.json';\r\nimport Topik1 from './deck/Topik1.json';\r\nimport JapaneseWords from './deck/JapaneseWords.json';\r\nimport KorBooks from './deck/KorBooks.json';\r\n\r\n\r\n/// --------- Local ----------------\r\n\r\nconst localStorage = window.localStorage;\r\n\r\nfunction getAllLocalData() {\r\n   return Data.concat(Topik1)\r\n              .concat(Coca)\r\n              .concat(JapaneseWords)\r\n              .concat(KorBooks);\r\n}\r\n\r\nfunction getProperty(entity, id, propertyName) {\r\n   const path = `${entity}/${id}/${propertyName}`;\r\n   return localStorage.getItem(path);\r\n}\r\n\r\nfunction setProperty(entity, id, propertyName, value) {\r\n   const path = `${entity}/${id}/${propertyName}`;\r\n   localStorage.setItem(path, value);\r\n}\r\n\r\nclass LocalUser {\r\n   async getName() {\r\n      await setTimeout(200);\r\n      let name = localStorage.getItem('name');\r\n      return name === null ? undefined : name;\r\n   }\r\n\r\n   async login(name, password, rememberMe) {\r\n      console.log(`Login: ${name}, ${password}, ${rememberMe}`);\r\n      await setTimeout(500);\r\n      localStorage.setItem('name', name);\r\n      localStorage.setItem('rememberMe', rememberMe);\r\n      return true;\r\n   }\r\n   \r\n   logout() {\r\n      console.log('Logout');\r\n      localStorage.removeItem('name');\r\n      localStorage.removeItem('rememberMe');\r\n      return true;\r\n   }\r\n   \r\n   async register(name, email, password) {\r\n      console.log(`Register: ${name}, ${email}, ${password}`);\r\n      await setTimeout(500);\r\n      localStorage.setItem('name', name);\r\n      localStorage.setItem('email', email);\r\n      return true;\r\n   }\r\n   delete() {\r\n      console.log(`Deleted`);\r\n      localStorage.removeItem('name');\r\n      localStorage.removeItem('rememberMe');\r\n      return true;\r\n   }\r\n   \r\n   async getDeckList() {\r\n      await setTimeout(100);\r\n      return getAllLocalData().map( (item, index) => {\r\n         return {\r\n            id: item.Id,\r\n            name: item.Name,\r\n            description: item.Description,\r\n            language: item.Language,\r\n            row_number: item.Rows.length\r\n         }\r\n      })\r\n   }\r\n   \r\n   async getDeck(id, fromRow, number) {\r\n      await setTimeout(100);\r\n      const data = getAllLocalData();\r\n      const deckData = data.find( (deck) => deck.Id === +id );\r\n      if (deckData === undefined)\r\n         return null;\r\n      \r\n      const rowsWithId = deckData.Rows.map((item, index) => {\r\n         const wordId = id * 100000 + index;\r\n         const transScore = +getProperty(`word`, wordId, `translation_score`);\r\n         return {\r\n         id: wordId,\r\n         word: item[0],\r\n         meaning: item[1],\r\n         extra: item[2],\r\n         score: Math.floor(transScore) // + getProperty(`word`, wordId, `word_score`) ?? 0) / 2,\r\n         }\r\n      }); \r\n      return {\r\n         id: id,\r\n         name: deckData.Name,\r\n         description: deckData.Description,\r\n         language: deckData.Language,\r\n         rows: rowsWithId\r\n      };\r\n   }\r\n   \r\n\r\n}\r\n\r\nclass LocalDeck {\r\n   async changeInfo(deckId, name, description, language) {\r\n   }\r\n   \r\n   async addWord(deckId, word, translation, extra) {\r\n   }\r\n   \r\n   async changeWord(wordId, word, translation, extra) {\r\n   }\r\n   \r\n   async deleteWord(wordId) {\r\n   }\r\n}\r\n\r\nfunction getScoreAfterTest(prevScore, succeeded) {\r\n   let newScore = 0;\r\n   if (prevScore === 0)\r\n      newScore = prevScore + (succeeded ? 1 : -1);\r\n   else if (prevScore > 0)\r\n      newScore = !succeeded ? Math.trunc(prevScore / 2) : prevScore + 1;\r\n   else\r\n      newScore =  succeeded ? Math.trunc(prevScore / 2) : prevScore - 1;\r\n   return newScore;\r\n}\r\n\r\nclass LocalTest {\r\n   static setScore(scoreName, wordId, succeeded) {\r\n      const prevScore = getProperty('word', wordId, 'translation_score')?? 0;\r\n      const newScore = getScoreAfterTest(+prevScore, succeeded);\r\n      console.log(`${scoreName}, ${wordId}, ${succeeded}, ${prevScore}, ${newScore}`)\r\n      setProperty('word', wordId, 'translation_score', newScore);\r\n   }\r\n   \r\n   async setTranslationTestResult(wordId, succeeded) {\r\n      LocalTest.setScore('translation_score', wordId, succeeded);\r\n      return true;\r\n   }\r\n   \r\n   async setWordTestResult(wordId, succeeded) {\r\n      LocalTest.setScore('word_score', wordId, succeeded);\r\n      return true;\r\n   }\r\n}\r\n\r\n//-------------------\r\n\r\nfunction init() {\r\n   return [new LocalUser(), new LocalDeck(), new LocalTest()];\r\n}\r\n\r\nconst [user, deck, test] = init();\r\n\r\nfunction getUser() {\r\n   return user;\r\n}\r\n\r\nfunction getTest() {\r\n   return test;\r\n}\r\n\r\nfunction getDeck() {\r\n   return deck;\r\n}\r\n\r\n\r\nexport { getUser, getTest, getDeck };","import React from 'react';\r\nimport { Link } from 'react-router-dom'\r\nimport { getUser } from './User.js';\r\n\r\nclass MatrixList extends React.Component {\r\n   constructor(props) {\r\n      super(props);\r\n      this.state = { decks: [] };\r\n   }\r\n   \r\n   async componentDidMount() {\r\n      const decks = await getUser().getDeckList();\r\n      this.setState({ decks: decks })\r\n   }\r\n\r\n   render() {\r\n      const rows = this.state.decks.map( (deck, index) =>\r\n         <tr key={index}>\r\n            <td><Link to={`/matrix?id=${deck.id}`}>{deck.name}</Link></td>\r\n            <td>{deck.description ?? ''}</td>\r\n            <td>{deck.language}</td>\r\n            <td className=\"text-right\">{deck.row_number}</td>\r\n         </tr>\r\n      );\r\n      return (\r\n         <table className=\"table table-nonfluid ml-1\">\r\n            <thead className=\"thead-light\">\r\n               <tr>\r\n                  <th>Название</th>\r\n                  <th>Описание</th>\r\n                  <th>Язык</th>\r\n                  <th>Кол-во записей</th>\r\n               </tr>\r\n            </thead>\r\n            <tbody>\r\n               {rows}\r\n            </tbody>\r\n         </table>\r\n      );\r\n   }\r\n}\r\n\r\nexport { MatrixList };","import React, { useState, useEffect } from \"react\";\r\nimport \"./Editable.css\";\r\n\r\nconst Editable = ({\r\n  text,\r\n  type,\r\n  placeholder,\r\n  children,\r\n  childRef,\r\n  ...props\r\n}) => {\r\n  const [isEditing, setEditing] = useState(false);\r\n\r\n  useEffect(() => {\r\n    if (childRef && childRef.current && isEditing === true) {\r\n      childRef.current.focus();\r\n    }\r\n  }, [isEditing, childRef]);\r\n\r\n  const handleKeyDown = (event, type) => {\r\n    const { key } = event;\r\n    const keys = [\"Escape\", \"Tab\"];\r\n    const enterKey = \"Enter\";\r\n    const allKeys = [...keys, enterKey];\r\n    if (\r\n      (type === \"textarea\" && keys.indexOf(key) > -1) ||\r\n      (type !== \"textarea\" && allKeys.indexOf(key) > -1)\r\n    ) {\r\n      setEditing(false);\r\n    }\r\n  };\r\n\r\n  //const styles = `rounded py-2 px-3 text-gray-700 leading-tight whitespace-pre-wrap hover:shadow-outline editable-${type}`;\r\n  return (\r\n    \r\n    <section {...props}>\r\n      {isEditing ? (\r\n        <div\r\n          onBlur={() => setEditing(false)}\r\n          onKeyDown={e => handleKeyDown(e, type)}\r\n        >\r\n          {children}\r\n        </div>\r\n      ) : (\r\n        <div\r\n          className={''}\r\n          onClick={() => setEditing(true)}\r\n        >\r\n          <span className={text ? \"text-black\" : \"text-muted font-italic small\"}>\r\n            {text || placeholder || \"Editable content\"}\r\n          </span>\r\n        </div>\r\n      )}\r\n    </section>\r\n  );\r\n};\r\n\r\nexport default Editable;","\r\nlet code_holder = '';\r\n\r\nfunction return_false() {\r\n    return false;\r\n}\r\n\r\n//New\r\nfunction release_selection(input) {\r\n   input.release_selection();\r\n   code_holder = '';\r\n}\r\n\r\nfunction clear_all(input) {\r\n   input.clear_all();\r\n   code_holder = '';\r\n}\r\n\r\nfunction replace_selection(input, str, highlight) {\r\n   input.replace_selection(str, highlight);\r\n}\r\n\r\n\r\n//--------------\r\n\r\nconst initial_table = [\"r\", \"R\", \"s\", \"e\", \"E\", \"f\", \"a\", \"q\", \"Q\", \"t\", \"T\", \"d\", \"w\", \"W\", \"c\", \"z\", \"x\", \"v\", \"g\"];\r\nconst medial_table = [\"k\", \"o\", \"i\", \"O\", \"j\", \"p\", \"u\", \"P\", \"h\", \"hk\", \"ho\", \"hl\", \"y\", \"n\", \"nj\", \"np\", \"nl\", \"b\", \"m\", \"ml\", \"l\"];\r\nconst final_table = [\"\", \"r\", \"R\", \"rt\", \"s\", \"sw\", \"sg\", \"e\", \"f\", \"fr\", \"fa\", \"fq\", \"ft\", \"fx\", \"fv\", \"fg\", \"a\", \"q\", \"qt\", \"t\", \"T\", \"d\", \"w\", \"c\", \"z\", \"x\", \"v\", \"g\"];\r\nconst jaso_table = [\"r\", \"R\", \"rt\", \"s\", \"sw\", \"sg\", \"e\", \"E\", \"f\", \"fr\", \"fa\", \"fq\", \"ft\", \"fx\", \"fv\", \"fg\", \"a\", \"q\", \"Q\", \"qt\", \"t\", \"T\", \"d\", \"w\", \"W\", \"c\", \"z\", \"x\", \"v\", \"g\", \"k\", \"o\", \"i\", \"O\", \"j\", \"p\", \"u\", \"P\", \"h\", \"hk\", \"ho\", \"hl\", \"y\", \"n\", \"nj\", \"np\", \"nl\", \"b\", \"m\", \"ml\", \"l\"];\r\n\r\n\r\nfunction compose_korean_char(input, alphabet) {\r\n    if (code_holder === '') {\r\n        for (let i = 0; i < jaso_table.length; i++) {\r\n            if (jaso_table[i] === alphabet) {\r\n                code_holder = String.fromCharCode(12593 + i);\r\n                replace_selection(input, code_holder, true);\r\n                return;\r\n            }\r\n        }\r\n    } else if (code_holder.charCodeAt(0) >= 44032 && code_holder.charCodeAt(0) < 44032 + 11172) {\r\n        var shift = code_holder.charCodeAt(0) - 44032;\r\n        var final_code = shift % 28;\r\n        var medial_code = (shift - final_code) / 28 % 21;\r\n        var initial_code = ((shift - final_code) / 28 - medial_code) / 21;\r\n        if (\"rRseEfaqQtTdwWczxvg\".indexOf(alphabet) !== -1) {\r\n            for (let i = 0; i < final_table.length; i++) {\r\n                if (final_table[i] === final_table[final_code] + alphabet) {\r\n                    code_holder = String.fromCharCode(initial_code * 588 + medial_code * 28 + i + 44032);\r\n                    replace_selection(input, code_holder, true);\r\n                    return;\r\n                }\r\n            }\r\n            replace_selection(input, code_holder, false);\r\n            for (let i = 0; i < jaso_table.length; i++) {\r\n                if (jaso_table[i] === alphabet) {\r\n                    code_holder = String.fromCharCode(12593 + i);\r\n                    replace_selection(input, code_holder, true);\r\n                    return;\r\n                }\r\n            }\r\n        } else if (\"koiOjpuPhynbml\".indexOf(alphabet) !== -1) {\r\n            if (final_table[final_code].length === 2) {\r\n                for (let i = 0; i < initial_table.length; i++) {\r\n                    if (initial_table[i] === final_table[final_code].charAt(1)) {\r\n                        for (let j = 0; j < medial_table.length; j++) {\r\n                            if (medial_table[j] === alphabet) {\r\n                                for (let k = 0; k < final_table.length; k++) {\r\n                                    if (final_table[k] === final_table[final_code].charAt(0)) {\r\n                                        replace_selection(input, String.fromCharCode(initial_code * 588 + medial_code * 28 + k + 44032), false);\r\n                                        code_holder = String.fromCharCode(i * 588 + j * 28 + 44032);\r\n                                        replace_selection(input, code_holder, true);\r\n                                        return;\r\n                                    }\r\n                                }\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            } else if (final_table[final_code].length === 1) {\r\n                for (let i = 0; i < initial_table.length; i++) {\r\n                    if (initial_table[i] === final_table[final_code]) {\r\n                        for (let j = 0; j < medial_table.length; j++) {\r\n                            if (medial_table[j] === alphabet) {\r\n                                replace_selection(input, String.fromCharCode(initial_code * 588 + medial_code * 28 + 0 + 44032), false);\r\n                                code_holder = String.fromCharCode(i * 588 + j * 28 + 44032);\r\n                                replace_selection(input, code_holder, true);\r\n                                return;\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n            } else {\r\n                for (let i = 0; i < medial_table.length; i++) {\r\n                    if (medial_table[i] === medial_table[medial_code] + alphabet) {\r\n                        code_holder = String.fromCharCode(initial_code * 588 + i * 28 + 44032);\r\n                        replace_selection(input, code_holder, true);\r\n                        return;\r\n                    }\r\n                }\r\n                for (let i = 0; i < jaso_table.length; i++) {\r\n                    if (jaso_table[i] === alphabet) {\r\n                        release_selection(input);\r\n                        code_holder = String.fromCharCode(12593 + i);\r\n                        replace_selection(input, code_holder, true);\r\n                        return;\r\n                    }\r\n                }\r\n            }\r\n        }\r\n    } else if (code_holder.charCodeAt(0) >= 12593 && code_holder.charCodeAt(0) < 12644) {\r\n        if (\"koiOjpuPhynbml\".indexOf(alphabet) !== -1 && code_holder.charCodeAt(0) >= 12593 && code_holder.charCodeAt(0) < 12593 + 30) {\r\n            var tmp = jaso_table[code_holder.charCodeAt(0) - 12593];\r\n            for (var i = 0; i < initial_table.length; i++) {\r\n                if (initial_table[i] === tmp) {\r\n                    for (var j = 0; j < medial_table.length; j++) {\r\n                        if (medial_table[j] === alphabet) {\r\n                            code_holder = String.fromCharCode(i * 588 + j * 28 + 44032);\r\n                            replace_selection(input, code_holder, true);\r\n                            return;\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            for (let i = 0; i < jaso_table.length; i++) {\r\n                if (jaso_table[i] === alphabet) {\r\n                    release_selection(input);\r\n                    code_holder = String.fromCharCode(12593 + i);\r\n                    replace_selection(input, code_holder, true);\r\n                    return;\r\n                }\r\n            }\r\n        }\r\n    } else {\r\n        for (let i = 0; i < jaso_table.length; i++) {\r\n            if (jaso_table[i] === alphabet) {\r\n                release_selection(input);\r\n                code_holder = String.fromCharCode(12593 + i);\r\n                replace_selection(input, code_holder, true);\r\n                return;\r\n            }\r\n        }\r\n    }\r\n}\r\n\r\n\r\nfunction key_down_korean(e, key, input_ctrl) {\r\n    switch (key) {\r\n        case 8:\r\n            if (code_holder !== '') {\r\n                if (code_holder.charCodeAt(0) >= 44032 && code_holder.charCodeAt(0) < 44032 + 11172) {\r\n                    var shift = code_holder.charCodeAt(0) - 44032;\r\n                    var final_code = shift % 28;\r\n                    var medial_code = (shift - final_code) / 28 % 21;\r\n                    var initial_code = ((shift - final_code) / 28 - medial_code) / 21;\r\n                    if (final_code !== 0) {\r\n                        for (let i = 0; i < final_table.length; i++) {\r\n                            if (final_table[i] === final_table[final_code].substring(0, final_table[final_code].length - 1)) {\r\n                                code_holder = String.fromCharCode(initial_code * 588 + medial_code * 28 + i + 44032);\r\n                                replace_selection(input_ctrl, code_holder, true);\r\n                                return return_false();\r\n                            }\r\n                        }\r\n                    } else if (medial_table[medial_code].length > 1) {\r\n                        for (let i = 0; i < medial_table.length; i++) {\r\n                            if (medial_table[i] === medial_table[medial_code].substring(0, medial_table[medial_code].length - 1)) {\r\n                                code_holder = String.fromCharCode(initial_code * 588 + i * 28 + 44032);\r\n                                replace_selection(input_ctrl, code_holder, true);\r\n                                return return_false();\r\n                            }\r\n                        }\r\n                    } else {\r\n                        for (let i = 0; i < jaso_table.length; i++) {\r\n                            if (jaso_table[i] === initial_table[initial_code]) {\r\n                                code_holder = String.fromCharCode(12593 + i);\r\n                                replace_selection(input_ctrl, code_holder, true);\r\n                                return return_false();\r\n                            }\r\n                        }\r\n                    }\r\n                }\r\n                release_selection(input_ctrl);\r\n            }\r\n            return true;\r\n        case 9:\r\n            release_selection(input_ctrl);\r\n            replace_selection(input_ctrl, '    ', false);\r\n            return return_false();\r\n        case 27:\r\n            clear_all(input_ctrl);\r\n            return return_false();\r\n        case 81:\r\n            compose_korean_char(input_ctrl, e.shiftKey ? 'Q' : 'q');\r\n            return return_false();\r\n        case 87:\r\n            compose_korean_char(input_ctrl, e.shiftKey ? 'W' : 'w');\r\n            return return_false();\r\n        case 69:\r\n            compose_korean_char(input_ctrl, e.shiftKey ? 'E' : 'e');\r\n            return return_false();\r\n        case 82:\r\n            compose_korean_char(input_ctrl, e.shiftKey ? 'R' : 'r');\r\n            return return_false();\r\n        case 84:\r\n            compose_korean_char(input_ctrl, e.shiftKey ? 'T' : 't');\r\n            return return_false();\r\n        case 89:\r\n            compose_korean_char(input_ctrl, 'y');\r\n            return return_false();\r\n        case 85:\r\n            compose_korean_char(input_ctrl, 'u');\r\n            return return_false();\r\n        case 73:\r\n            compose_korean_char(input_ctrl, 'i');\r\n            return return_false();\r\n        case 79:\r\n            compose_korean_char(input_ctrl, e.shiftKey ? 'O' : 'o');\r\n            return return_false();\r\n        case 80:\r\n            compose_korean_char(input_ctrl, e.shiftKey ? 'P' : 'p');\r\n            return return_false();\r\n        case 220:\r\n            if (!e.shiftKey) {\r\n                replace_selection(input_ctrl, '￦', false);\r\n                return return_false();\r\n            }\r\n            return true;\r\n        case 65:\r\n            compose_korean_char(input_ctrl, 'a');\r\n            return return_false();\r\n        case 83:\r\n            compose_korean_char(input_ctrl, 's');\r\n            return return_false();\r\n        case 68:\r\n            compose_korean_char(input_ctrl, 'd');\r\n            return return_false();\r\n        case 70:\r\n            compose_korean_char(input_ctrl, 'f');\r\n            return return_false();\r\n        case 71:\r\n            compose_korean_char(input_ctrl, 'g');\r\n            return return_false();\r\n        case 72:\r\n            compose_korean_char(input_ctrl, 'h');\r\n            return return_false();\r\n        case 74:\r\n            compose_korean_char(input_ctrl, 'j');\r\n            return return_false();\r\n        case 75:\r\n            compose_korean_char(input_ctrl, 'k');\r\n            return return_false();\r\n        case 76:\r\n            compose_korean_char(input_ctrl, 'l');\r\n            return return_false();\r\n        case 90:\r\n            compose_korean_char(input_ctrl, 'z');\r\n            return return_false();\r\n        case 88:\r\n            compose_korean_char(input_ctrl, 'x');\r\n            return return_false();\r\n        case 67:\r\n            compose_korean_char(input_ctrl, 'c');\r\n            return return_false();\r\n        case 86:\r\n            compose_korean_char(input_ctrl, 'v');\r\n            return return_false();\r\n        case 66:\r\n            compose_korean_char(input_ctrl, 'b');\r\n            return return_false();\r\n        case 78:\r\n            compose_korean_char(input_ctrl, 'n');\r\n            return return_false();\r\n        case 77:\r\n            compose_korean_char(input_ctrl, 'm');\r\n            return return_false();\r\n        case 16:\r\n            return true;\r\n        default:\r\n            release_selection(input_ctrl);\r\n    }\r\n}\r\n\r\nfunction key_down(e, input_ctrl) {\r\n   var key = e.which ? e.which : e.keyCode;\r\n   return key_down_korean(e, key, input_ctrl)\r\n}\r\n\r\nexport {key_down}","import $ from 'jquery';\r\nimport { createPopper } from '@popperjs/core';\r\n\r\n\r\nconst disp_number = 10;  // 10 words a page\r\n\r\nlet code_holder = '';  //  symbols yet input\r\nlet left_yinhao1 = false; // ' quotes\r\nlet left_yinhao2 = false; // \" quotes\r\n\r\nfunction return_false() {\r\n    return false;\r\n}\r\n\r\n//New\r\nfunction release_selection(input) {\r\n   input.release_selection();\r\n   input.callback.hide_popup();\r\n   code_holder = '';\r\n}\r\n\r\nfunction clear_all(input) {\r\n   input.clear_all();\r\n   input.callback.hide_popup();\r\n   code_holder = '';\r\n}\r\n\r\nfunction replace_selection(input, str, highlight) {\r\n   input.replace_selection(str, highlight);\r\n}\r\n\r\n\r\n/*\r\nconst InputMode = Object.freeze({\r\n   HIRAGANA: 1,\r\n   KATAKANA: 2,\r\n   ENGLISH_FULLWIDTH: 3,\r\n   ENGLISH_HALFWIDHT: 4\r\n});*/\r\n\r\nfunction display_words(direction) {\r\n    alert('Not implemented');\r\n}\r\n\r\nclass Callback {\r\n   constructor(input_ctrl) {\r\n      this.word_lists = undefined; // 2D array\r\n      this.splits = undefined; // 1D array\r\n      this.page_number = undefined;\r\n      this.list_index = 0;\r\n      this.input = input_ctrl.input;\r\n      this.input_ctrl = input_ctrl;\r\n      this.show_hiragana = true;\r\n   }\r\n   // have a selection\r\n   is_word_div_visible() {  // $('.word_div:visible').length > 0\r\n      return this.words_in_list() > 0;\r\n   }\r\n   // get the currently selected word\r\n   get_word_div_visible() {\r\n      return $('.word', this.menu).index($('.active'))\r\n   }\r\n   // get the number of words in the popup (current page)\r\n   words_in_list() {\r\n      return $('.word', this.menu).length;\r\n   }\r\n   \r\n   insert_word(index) {\r\n      const text = $('.word').eq(index).data('text');\r\n      replace_selection(this.input_ctrl, text, false);\r\n      code_holder = code_holder.substr(this.splits[this.list_index].length);\r\n      replace_selection(this.input_ctrl, code_holder, true);\r\n      ++this.list_index;\r\n      if (this.list_index < this.word_lists.length) {\r\n         display_words(\"next\");\r\n      } else {\r\n         this.hide_popup();\r\n      }\r\n   }\r\n\r\n   prev_page() {\r\n      if(this.menu === undefined)\r\n         return;\r\n      if(this.page_number === 0)\r\n         return;\r\n      --this.page_number;\r\n      $('.dropdown-item', this.menu).remove();\r\n      this.populateMenu(this.menu);\r\n      this.highlight_word(\"first\");\r\n   }\r\n   next_page() {\r\n      if(this.menu === undefined)\r\n         return;\r\n      if((this.page_number + 1) * disp_number > this.word_lists[this.list_index].length)\r\n         return;\r\n      $('.dropdown-item', this.menu).remove();\r\n      ++this.page_number;\r\n      this.populateMenu(this.menu);\r\n      this.highlight_word(\"first\");\r\n   }\r\n\r\n   show_popup(word) {\r\n      fetch(\"https://www.inputking.com/ime/getwords.php?&p1=japanese&p2=\" + word + \"&is_vip=\",\r\n         {\r\n            method: 'GET',\r\n            cors: 'no-cors',\r\n            referrerPolicy: \"no-referrer\",\r\n            headers: {\r\n               'Content-Type': 'application/x-javascript',\r\n            }\r\n         }\r\n      )\r\n      .then(response => { \r\n         return response.text();\r\n      })\r\n      .then(data => {\r\n          const reWords = /words\\[\\d+\\]=\\[(.*?)\\]/g;\r\n          const reSplits = /splits=\\[(.*?)\\]/;\r\n          let word_lists = [];\r\n          for(let word of data.matchAll(reWords)) {\r\n             const words = word[1].split(\",\").map( w => w.substr(1, w.length - 2) );\r\n             //console.log(words);\r\n             word_lists.push(words);\r\n          }\r\n          const splitWord = data.match(reSplits);\r\n          const splits = splitWord[1].split(\",\").map( w => w.substr(1, w.length - 2) );\r\n        //  console.log(`splits: ${splits}`);\r\n          this.createMenu(word_lists, typeof splits == String ? [splits] : splits);\r\n      });\r\n   }\r\n   hide_popup() {\r\n      if(this.menu)\r\n         this.menu.remove();\r\n      this.menu = undefined;\r\n      this.splits = undefined;\r\n      this.word_lists = undefined;\r\n      this.list_index = undefined;\r\n   }\r\n\r\n   highlight_word(which) {\r\n      switch(which) {\r\n      case \"first\":\r\n         $('.word', this.menu).removeClass('active');\r\n         $('.word', this.menu).eq(0).addClass('active');\r\n         break;\r\n      case \"last\":\r\n      case \"prev\": {\r\n            const all = $('.word, .active', this.menu);\r\n            const index = all.index();\r\n            $('.word', this.menu).removeClass('active');\r\n            if(index > 0)\r\n               all.eq(index-1).addClass('active');\r\n            else\r\n               this.prev_page();\r\n         }\r\n         break;\r\n      case \"next\": {\r\n            const all = $('.word, .active', this.menu);\r\n            const index = all.index();\r\n            $('.word', this.menu).removeClass('active');\r\n            if(index < all.length - 1)\r\n               $('.word', this.menu).eq(index+1).addClass('active');\r\n            else\r\n               this.next_page();\r\n         }\r\n         break;\r\n      default:\r\n      }\r\n   }\r\n   \r\n   ////  internals  \r\n   populateMenu(menu) {\r\n      const startWordIndex = this.page_number * disp_number;\r\n      const endWordIndex = Math.min((this.page_number + 1) * disp_number,\r\n                                    this.word_lists[this.list_index].length);\r\n      if(this.page_number > 0) {\r\n         const pageUp = $(`<button class=\"pageup\">&#x2BC5;<span class=\"border rounded ml-1\"><kbd>PgUp</<kbd></span></button>`);\r\n         pageUp.addClass('dropdown-item')\r\n               .css('padding', '0.25rem 0.5rem');\r\n         menu.append(pageUp);\r\n      }\r\n      for(let i = startWordIndex; i < endWordIndex; ++i) {\r\n         const index = (i - startWordIndex + 1) % disp_number;\r\n         const itemText = this.word_lists[this.list_index][i];\r\n         const link = $(`<a href='#'><small>${index}. </small>${itemText}</a>`);\r\n         link.addClass('dropdown-item')\r\n             .addClass('word')\r\n             .data('text', itemText)\r\n             .css('padding', '0.25rem 0.5rem');\r\n         link.click( (e) => {\r\n            $(menu).remove();\r\n         });\r\n         menu.append(link);\r\n      }\r\n      if((this.page_number + 1) * disp_number < this.word_lists[this.list_index].length) {\r\n         const pageDn = $(`<button class=\"pagedown\">&#x2BC6;<span class=\"border rounded ml-1\"><kbd>PgDn</<kbd></span></button>`);\r\n         pageDn.addClass('dropdown-item')\r\n               .css('padding', '0.25rem 0.5rem');\r\n         menu.append(pageDn);\r\n      }\r\n      $(\".pageup\", menu).click(e => {\r\n         this.prev_page();\r\n      });\r\n      $(\".pagedown\", menu).click(e => {\r\n         this.next_page();\r\n      });\r\n   }\r\n   \r\n   createMenu(word_lists, splits) {\r\n      this.word_lists = word_lists;\r\n      this.splits = splits;\r\n      this.page_number = 0;\r\n      this.list_index = 0;\r\n\r\n      let menu = $('<div/>');\r\n      menu.addClass('bg-white').addClass('border');\r\n      menu.css('z-index', 3000);\r\n      this.populateMenu(menu);\r\n      \r\n      $(this.input).after(menu);\r\n      this.menu = menu;\r\n      this.highlight_word(\"first\");\r\n\r\n      createPopper($(this.input)[0], $(menu)[0], {\r\n         placement: 'bottom',\r\n      });\r\n   }\r\n}\r\n\r\n\r\n//------------------------------------\r\n\r\nconst key_en = \"`1234567890-=qwertyuiop[]\\\\asdfghjkl;'zxcvbnm,./\";\r\nconst key_char_quan = \"｀１２３４５６７８９０－＝ｑｗｅｒｔｙｕｉｏｐ［］＼ａｓｄｆｇｈｊｋｌ；＇ｚｘｃｖｂｎｍ，．／\";\r\nconst romaji_array = [\r\n    ['ａ', 'あ', 'ア'],\r\n    ['ｉ', 'い', 'イ'],\r\n    ['ｙｉ', 'い', 'イ'],\r\n    ['ｕ', 'う', 'ウ'],\r\n    ['ｗｕ', 'う', 'ウ'],\r\n    ['ｗｈｕ', 'う', 'ウ'],\r\n    ['ｅ', 'え', 'エ'],\r\n    ['ｏ', 'お', 'オ'],\r\n    ['ｘａ', 'ぁ', 'ァ'],\r\n    ['ｌａ', 'ぁ', 'ァ'],\r\n    ['ｘｉ', 'ぃ', 'ィ'],\r\n    ['ｌｉ', 'ぃ', 'ィ'],\r\n    ['ｌｙｉ', 'ぃ', 'ィ'],\r\n    ['ｘｙｉ', 'ぃ', 'ィ'],\r\n    ['ｘｕ', 'ぅ', 'ゥ'],\r\n    ['ｌｕ', 'ぅ', 'ゥ'],\r\n    ['ｘｅ', 'ぇ', 'ェ'],\r\n    ['ｌｅ', 'ぇ', 'ェ'],\r\n    ['ｌｙｅ', 'ぇ', 'ェ'],\r\n    ['ｘｙｅ', 'ぇ', 'ェ'],\r\n    ['ｘｏ', 'ぉ', 'ォ'],\r\n    ['ｌｏ', 'ぉ', 'ォ'],\r\n    ['ｗｉ', 'うぃ', 'ウィ'],\r\n    ['ｗｅ', 'うぇ', 'ウェ'],\r\n    ['ｖｕ', 'ヴ', 'ヴ'],\r\n    ['ｖａ', 'ヴぁ', 'ヴァ'],\r\n    ['ｖｉ', 'ヴぃ', 'ヴィ'],\r\n    ['ｖｙｉ', 'ヴぃ', 'ヴィ'],\r\n    ['ｖｅ', 'ヴぇ', 'ヴェ'],\r\n    ['ｖｙｅ', 'ヴぇ', 'ヴェ'],\r\n    ['ｖｏ', 'ヴぉ', 'ヴォ'],\r\n    ['ｋａ', 'か', 'カ'],\r\n    ['ｃａ', 'か', 'カ'],\r\n    ['ｋｉ', 'き', 'キ'],\r\n    ['ｋｕ', 'く', 'ク'],\r\n    ['ｃｕ', 'く', 'ク'],\r\n    ['ｑｕ', 'く', 'ク'],\r\n    ['ｋｅ', 'け', 'ケ'],\r\n    ['ｋｏ', 'こ', 'コ'],\r\n    ['ｃｏ', 'こ', 'コ'],\r\n    ['ｋｙａ', 'きゃ', 'キャ'],\r\n    ['ｋｙｉ', 'きぃ', 'キィ'],\r\n    ['ｋｙｕ', 'きゅ', 'キュ'],\r\n    ['ｋｙｅ', 'きぇ', 'キェ'],\r\n    ['ｋｙｏ', 'きょ', 'キョ'],\r\n    ['ｇａ', 'が', 'ガ'],\r\n    ['ｇｉ', 'ぎ', 'ギ'],\r\n    ['ｇｕ', 'ぐ', 'グ'],\r\n    ['ｇｅ', 'げ', 'ゲ'],\r\n    ['ｇｏ', 'ご', 'ゴ'],\r\n    ['ｇｙａ', 'ぎゃ', 'ギャ'],\r\n    ['ｇｙｉ', 'ぎぃ', 'ギィ'],\r\n    ['ｇｙｕ', 'ぎゅ', 'ギュ'],\r\n    ['ｇｙｅ', 'ぎぇ', 'ギェ'],\r\n    ['ｇｙｏ', 'ぎょ', 'ギョ'],\r\n    ['ｓａ', 'さ', 'サ'],\r\n    ['ｓｉ', 'し', 'シ'],\r\n    ['ｃｉ', 'し', 'シ'],\r\n    ['ｓｈｉ', 'し', 'シ'],\r\n    ['ｓｕ', 'す', 'ス'],\r\n    ['ｓｅ', 'せ', 'セ'],\r\n    ['ｃｅ', 'せ', 'セ'],\r\n    ['ｓｏ', 'そ', 'ソ'],\r\n    ['ｓｙａ', 'しゃ', 'シャ'],\r\n    ['ｓｈａ', 'しゃ', 'シャ'],\r\n    ['ｓｙｉ', 'しぃ', 'シィ'],\r\n    ['ｓｙｕ', 'しゅ', 'シュ'],\r\n    ['ｓｈｕ', 'しゅ', 'シュ'],\r\n    ['ｓｙｅ', 'しぇ', 'シェ'],\r\n    ['ｓｈｅ', 'しぇ', 'シェ'],\r\n    ['ｓｙｏ', 'しょ', 'ショ'],\r\n    ['ｓｈｏ', 'しょ', 'ショ'],\r\n    ['ｚａ', 'ざ', 'ザ'],\r\n    ['ｚｉ', 'じ', 'ジ'],\r\n    ['ｊｉ', 'じ', 'ジ'],\r\n    ['ｚｕ', 'ず', 'ズ'],\r\n    ['ｚｅ', 'ぜ', 'ゼ'],\r\n    ['ｚｏ', 'ぞ', 'ゾ'],\r\n    ['ｚｙａ', 'じゃ', 'ジャ'],\r\n    ['ｊａ', 'じゃ', 'ジャ'],\r\n    ['ｊｙａ', 'じゃ', 'ジャ'],\r\n    ['ｚｙｉ', 'じぃ', 'ジィ'],\r\n    ['ｊｙｉ', 'じぃ', 'ジィ'],\r\n    ['ｚｙｕ', 'じゅ', 'ジュ'],\r\n    ['ｊｕ', 'じゅ', 'ジュ'],\r\n    ['ｊｙｕ', 'じゅ', 'ジュ'],\r\n    ['ｚｙｅ', 'じぇ', 'ジェ'],\r\n    ['ｊｅ', 'じぇ', 'ジェ'],\r\n    ['ｊｙｅ', 'じぇ', 'ジェ'],\r\n    ['ｚｙｏ', 'じょ', 'ジョ'],\r\n    ['ｊｏ', 'じょ', 'ジョ'],\r\n    ['ｊｙｏ', 'じょ', 'ジョ'],\r\n    ['ｔａ', 'た', 'タ'],\r\n    ['ｔｉ', 'ち', 'チ'],\r\n    ['ｃｈｉ', 'ち', 'チ'],\r\n    ['ｔｕ', 'つ', 'ツ'],\r\n    ['ｔｓｕ', 'つ', 'ツ'],\r\n    ['ｔｅ', 'て', 'テ'],\r\n    ['ｔｏ', 'と', 'ト'],\r\n    ['ｔｙａ', 'ちゃ', 'チャ'],\r\n    ['ｃｈａ', 'ちゃ', 'チャ'],\r\n    ['ｃｙａ', 'ちゃ', 'チャ'],\r\n    ['ｔｙｉ', 'ちぃ', 'チィ'],\r\n    ['ｃｙｉ', 'ちぃ', 'チィ'],\r\n    ['ｔｙｕ', 'ちゅ', 'チュ'],\r\n    ['ｃｈｕ', 'ちゅ', 'チュ'],\r\n    ['ｃｙｕ', 'ちゅ', 'チュ'],\r\n    ['ｔｙｅ', 'ちぇ', 'チェ'],\r\n    ['ｃｈｅ', 'ちぇ', 'チェ'],\r\n    ['ｃｙｅ', 'ちぇ', 'チェ'],\r\n    ['ｔｙｏ', 'ちょ', 'チョ'],\r\n    ['ｃｈｏ', 'ちょ', 'チョ'],\r\n    ['ｃｙｏ', 'ちょ', 'チョ'],\r\n    ['ｘｔｕ', 'っ', 'ッ'],\r\n    ['ｌｔｕ', 'っ', 'ッ'],\r\n    ['ｌｔｓｕ', 'っ', 'ッ'],\r\n    ['ｔｈｉ', 'てぃ', 'ティ'],\r\n    ['ｔｈｕ', 'てゅ', 'テュ'],\r\n    ['ｔｈｅ', 'てぇ', 'テェ'],\r\n    ['ｔｈｏ', 'てょ', 'テョ'],\r\n    ['ｄａ', 'だ', 'ダ'],\r\n    ['ｄｉ', 'ぢ', 'ヂ'],\r\n    ['ｄｕ', 'づ', 'ヅ'],\r\n    ['ｄｅ', 'で', 'デ'],\r\n    ['ｄｏ', 'ど', 'ド'],\r\n    ['ｄｙａ', 'ぢゃ', 'ヂャ'],\r\n    ['ｄｙｉ', 'ぢぃ', 'ヂィ'],\r\n    ['ｄｙｕ', 'ぢゅ', 'ヂュ'],\r\n    ['ｄｙｅ', 'ぢぇ', 'ヂェ'],\r\n    ['ｄｙｏ', 'ぢょ', 'ヂョ'],\r\n    ['ｄｈａ', 'でゃ', 'デャ'],\r\n    ['ｄｈｉ', 'でぃ', 'ディ'],\r\n    ['ｄｈｕ', 'でゅ', 'デュ'],\r\n    ['ｄｈｅ', 'でぇ', 'デェ'],\r\n    ['ｄｈｏ', 'でょ', 'デョ'],\r\n    ['ｎａ', 'な', 'ナ'],\r\n    ['ｎｉ', 'に', 'ニ'],\r\n    ['ｎｕ', 'ぬ', 'ヌ'],\r\n    ['ｎｅ', 'ね', 'ネ'],\r\n    ['ｎｏ', 'の', 'ノ'],\r\n    ['ｎｙａ', 'にゃ', 'ニャ'],\r\n    ['ｎｙｉ', 'にぃ', 'ニィ'],\r\n    ['ｎｙｕ', 'にゅ', 'ニュ'],\r\n    ['ｎｙｅ', 'にぇ', 'ニェ'],\r\n    ['ｎｙｏ', 'にょ', 'ニョ'],\r\n    ['ｈａ', 'は', 'ハ'],\r\n    ['ｈｉ', 'ひ', 'ヒ'],\r\n    ['ｈｕ', 'ふ', 'フ'],\r\n    ['ｆｕ', 'ふ', 'フ'],\r\n    ['ｈｅ', 'へ', 'ヘ'],\r\n    ['ｈｏ', 'ほ', 'ホ'],\r\n    ['ｈｙａ', 'ひゃ', 'ヒャ'],\r\n    ['ｈｙｉ', 'ひぃ', 'ヒィ'],\r\n    ['ｈｙｕ', 'ひゅ', 'ヒュ'],\r\n    ['ｈｙｅ', 'ひぇ', 'ヒェ'],\r\n    ['ｈｙｏ', 'ひょ', 'ヒョ'],\r\n    ['ｆｙａ', 'ふゃ', 'フャ'],\r\n    ['ｆｙｕ', 'ふゅ', 'フュ'],\r\n    ['ｆｙｏ', 'ふょ', 'フョ'],\r\n    ['ｆａ', 'ふぁ', 'ファ'],\r\n    ['ｆｉ', 'ふぃ', 'フィ'],\r\n    ['ｆｙｉ', 'ふぃ', 'フィ'],\r\n    ['ｆｅ', 'ふぇ', 'フェ'],\r\n    ['ｆｙｅ', 'ふぇ', 'フェ'],\r\n    ['ｆｏ', 'ふぉ', 'フォ'],\r\n    ['ｂａ', 'ば', 'バ'],\r\n    ['ｂｉ', 'び', 'ビ'],\r\n    ['ｂｕ', 'ぶ', 'ブ'],\r\n    ['ｂｅ', 'べ', 'ベ'],\r\n    ['ｂｏ', 'ぼ', 'ボ'],\r\n    ['ｂｙａ', 'びゃ', 'ビャ'],\r\n    ['ｂｙｉ', 'びぃ', 'ビィ'],\r\n    ['ｂｙｕ', 'びゅ', 'ビュ'],\r\n    ['ｂｙｅ', 'びぇ', 'ビェ'],\r\n    ['ｂｙｏ', 'びょ', 'ビョ'],\r\n    ['ｖａ', 'ヴぁ', 'ヴァ'],\r\n    ['ｖｉ', 'ヴぃ', 'ヴィ'],\r\n    ['ｖｕ', 'ヴ', 'ヴ'],\r\n    ['ｖｅ', 'ヴぇ', 'ヴェ'],\r\n    ['ｖｏ', 'ヴぉ', 'ヴォ'],\r\n    ['ｐａ', 'ぱ', 'パ'],\r\n    ['ｐｉ', 'ぴ', 'ピ'],\r\n    ['ｐｕ', 'ぷ', 'プ'],\r\n    ['ｐｅ', 'ぺ', 'ペ'],\r\n    ['ｐｏ', 'ぽ', 'ポ'],\r\n    ['ｐｙａ', 'ぴゃ', 'ピャ'],\r\n    ['ｐｙｉ', 'ぴぃ', 'ピィ'],\r\n    ['ｐｙｕ', 'ぴゅ', 'ピュ'],\r\n    ['ｐｙｅ', 'ぴぇ', 'ピェ'],\r\n    ['ｐｙｏ', 'ぴょ', 'ピョ'],\r\n    ['ｍａ', 'ま', 'マ'],\r\n    ['ｍｉ', 'み', 'ミ'],\r\n    ['ｍｕ', 'む', 'ム'],\r\n    ['ｍｅ', 'め', 'メ'],\r\n    ['ｍｏ', 'も', 'モ'],\r\n    ['ｍｙａ', 'みゃ', 'ミャ'],\r\n    ['ｍｙｉ', 'みぃ', 'ミィ'],\r\n    ['ｍｙｕ', 'みゅ', 'ミュ'],\r\n    ['ｍｙｅ', 'みぇ', 'ミェ'],\r\n    ['ｍｙｏ', 'みょ', 'ミョ'],\r\n    ['ｙａ', 'や', 'ヤ'],\r\n    ['ｙｕ', 'ゆ', 'ユ'],\r\n    ['ｙｏ', 'よ', 'ヨ'],\r\n    ['ｘｙａ', 'ゃ', 'ャ'],\r\n    ['ｌｙａ', 'ゃ', 'ャ'],\r\n    ['ｘｙｕ', 'ゅ', 'ュ'],\r\n    ['ｌｙｕ', 'ゅ', 'ュ'],\r\n    ['ｘｙｏ', 'ょ', 'ョ'],\r\n    ['ｌｙｏ', 'ょ', 'ョ'],\r\n    ['ｒａ', 'ら', 'ラ'],\r\n    ['ｒｉ', 'り', 'リ'],\r\n    ['ｒｕ', 'る', 'ル'],\r\n    ['ｒｅ', 'れ', 'レ'],\r\n    ['ｒｏ', 'ろ', 'ロ'],\r\n    ['ｒｙａ', 'りゃ', 'リャ'],\r\n    ['ｒｙｉ', 'りぃ', 'リィ'],\r\n    ['ｒｙｕ', 'りゅ', 'リュ'],\r\n    ['ｒｙｅ', 'りぇ', 'リェ'],\r\n    ['ｒｙｏ', 'りょ', 'リョ'],\r\n    ['ｗａ', 'わ', 'ワ'],\r\n    ['ｗｏ', 'を', 'ヲ'],\r\n    ['ｎｎ', 'ん', 'ン'],\r\n    ['ｎ＇', 'ん', 'ン'],\r\n    ['ｘｎ', 'ん', 'ン'],\r\n    ['ｘｗａ', 'ゎ', 'ヮ'],\r\n    ['ｌｗａ', 'ゎ', 'ヮ']\r\n];\r\n\r\nfunction alphabet_to_kana(input, char, show_hiragana) {\r\n    if(show_hiragana === undefined) alert(\"No kana parameter defined\");\r\n    const show_katakana = !show_hiragana;\r\n    let i = 0;\r\n    for (; i < code_holder.length; i++) {\r\n        if (key_char_quan.indexOf(code_holder.substr(i, 1)) !== -1) break;\r\n    }\r\n    if (show_katakana && char === \"ー\" && i === code_holder.length) {\r\n        code_holder += \"ー\";\r\n        replace_selection(input, code_holder, true);\r\n        return;\r\n    } else {\r\n        if (i < code_holder.length) {\r\n            var head_str = code_holder.substr(0, i);\r\n            var rear_str = code_holder.substr(i);\r\n            if (rear_str === char && char !== \"ｎ\") {\r\n                code_holder += char;\r\n                replace_selection(input, code_holder, true);\r\n                return;\r\n            }\r\n            if (rear_str === \"ｎ\" && char !== \"ａ\" && char !== \"ｉ\" && char !== \"ｕ\" && char !== \"ｅ\" && char !== \"ｏ\" && char !== \"ｙ\" && char !== \"ｎ\") {\r\n                code_holder = head_str + (show_hiragana ? \"ん\" : \"ン\") + char;\r\n                replace_selection(input, code_holder, true);\r\n                return;\r\n            } else if (rear_str.length >= 2 && rear_str.substr(0, 1) === rear_str.substr(1, 1)) {\r\n                const kana = find_hiragana(rear_str.substr(1) + char, show_hiragana);\r\n                if (kana !== \"\") {\r\n                    code_holder = head_str + (show_hiragana ? \"っ\" : \"ッ\") + kana;\r\n                    replace_selection(input, code_holder, true);\r\n                } else check_romaji(input, rear_str.substr(1) + char);\r\n                return;\r\n            } else {\r\n                const kana = find_hiragana(rear_str + char, show_hiragana);\r\n                if (kana !== \"\") {\r\n                    code_holder = head_str + kana;\r\n                    replace_selection(input, code_holder, true);\r\n                } else check_romaji(input, rear_str + char);\r\n            }\r\n        } else {\r\n            const kana = find_hiragana(char, show_hiragana);\r\n            if (kana !== \"\") code_holder += kana;\r\n            else code_holder += char;\r\n            replace_selection(input, code_holder, true);\r\n        }\r\n    }\r\n}\r\n\r\nfunction find_hiragana(str, show_hiragana) {\r\n    if(show_hiragana===undefined) alert(\"No kana parameter defined\"); // temp, delete after testing\r\n    if (show_hiragana) {\r\n        for (let i = 0; i < romaji_array.length; i++) {\r\n            if (romaji_array[i][0] === str) return romaji_array[i][1];\r\n        }\r\n    } else { // katakana\r\n        for (let i = 0; i < romaji_array.length; i++) {\r\n            if (romaji_array[i][0] === str) return romaji_array[i][2];\r\n        }\r\n    }\r\n    return \"\";\r\n}\r\n\r\nfunction check_romaji(input, str) {\r\n    for (var i = 0; i < romaji_array.length; i++) {\r\n        if (romaji_array[i][0].indexOf(str) === 0) {\r\n            code_holder += str.substr(str.length - 1, 1);\r\n            replace_selection(input, code_holder, true);\r\n            return;\r\n        }\r\n    }\r\n    $('#key_error').show(); // error romaji symbol\r\n}\r\n\r\n\r\nfunction key_down_japanese(e, key, input_ctrl, callback) {\r\n    const show_hiragana = callback.show_hiragana;\r\n    switch (key) {\r\n        case 8:\r\n            if (code_holder !== '') {\r\n                code_holder = code_holder.substr(0, code_holder.length - 1);\r\n                replace_selection(input_ctrl, code_holder, true);\r\n                //$('#word_list').hide();\r\n                callback.hide_popup();\r\n                return return_false();\r\n            }\r\n            return true;\r\n        case 9:\r\n            if (code_holder === '') replace_selection(input_ctrl, '    ', false);\r\n            return return_false();\r\n        case 27:\r\n            clear_all(input_ctrl);\r\n            return return_false();\r\n        case 33:  // page up\r\n            if (code_holder !== '') {\r\n                //if ($('#last_list').is(':visible')) last_page();\r\n                callback.prev_page();\r\n                return return_false();\r\n            }\r\n            return true;\r\n        case 34:  // page down\r\n            if (code_holder !== '') {\r\n                //if ($('#next_list').is(':visible')) next_page();\r\n                callback.next_page();\r\n                return return_false();\r\n            }\r\n            return true;\r\n        case 32:  // space\r\n            if (code_holder !== '') {\r\n                if (!callback.is_word_div_visible()) {\r\n                    if (show_hiragana) {\r\n                        var str = \"\";\r\n                        for (let i = 0; i < code_holder.length; i++) {\r\n                            for (let j = 0; j < romaji_array.length; j++) {\r\n                                if (romaji_array[j][1] === code_holder.substr(i, 1)) {\r\n                                    str += romaji_array[j][0];\r\n                                    break;\r\n                                }\r\n                            }\r\n                        }\r\n                        let p2 = \"\";\r\n                        for (let i = 0; i < str.length; i++) {\r\n                            p2 += key_en.substr(key_char_quan.indexOf(str.substr(i, 1)), 1);\r\n                        }\r\n                        callback.show_popup(p2);\r\n                    }\r\n                } else {\r\n                    callback.highlight_word('next');\r\n                }\r\n            } else replace_selection(input_ctrl, '　', false);\r\n            return return_false();\r\n        case 13:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n                return return_false();\r\n            } else if (code_holder !== '') {\r\n                release_selection(input_ctrl);\r\n                return return_false();\r\n            }\r\n            return true;\r\n        case 17:\r\n            return true;\r\n        case 38:  // up arrow\r\n            if (callback.is_word_div_visible()) {\r\n                callback.highlight_word('last');\r\n                return return_false();\r\n            }\r\n            return true;\r\n        case 40:  // down arrow\r\n            if (callback.is_word_div_visible()) {\r\n                callback.highlight_word('next');\r\n                return return_false();\r\n            }\r\n            return true;\r\n        case 37:\r\n        case 39:\r\n        case 46:\r\n        case 36:\r\n        case 35:\r\n            if (code_holder !== '') return return_false();\r\n            return true;\r\n        case 192:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '～' : '‘', false);\r\n            return return_false();\r\n        case 49:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '！', false);\r\n            } else {\r\n                if (callback.is_word_div_visible()) callback.insert_word(0);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '１', false);\r\n            }\r\n            return return_false();\r\n        case 50:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '＠', false);\r\n            } else {\r\n                if (callback.words_in_list() > 1) callback.insert_word(1);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '２', false);\r\n            }\r\n            return return_false();\r\n        case 51:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '＃', false);\r\n            } else {\r\n                if (callback.words_in_list() > 2) callback.insert_word(2);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '３', false);\r\n            }\r\n            return return_false();\r\n        case 52:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '＄', false);\r\n            } else {\r\n                if (callback.words_in_list() > 3) callback.insert_word(3);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '４', false);\r\n            }\r\n            return return_false();\r\n        case 53:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '％', false);\r\n            } else {\r\n                if (callback.words_in_list() > 4) callback.insert_word(4);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '５', false);\r\n            }\r\n            return return_false();\r\n        case 54:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '＾', false);\r\n            } else {\r\n                if (callback.words_in_list() > 5) callback.insert_word(5);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '６', false);\r\n            }\r\n            return return_false();\r\n        case 55:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '＆', false);\r\n            } else {\r\n                if (callback.words_in_list() > 6) callback.insert_word(6);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '７', false);\r\n            }\r\n            return return_false();\r\n        case 56:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '＊', false);\r\n            } else {\r\n                if (callback.words_in_list() > 7) callback.insert_word(7);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '８', false);\r\n            }\r\n            return return_false();\r\n        case 57:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '（', false);\r\n            } else {\r\n                if (callback.words_in_list() > 8) callback.insert_word(8);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '９', false);\r\n            }\r\n            return return_false();\r\n        case 48:\r\n            if (e.shiftKey) {\r\n                if (callback.is_word_div_visible()) {\r\n                    callback.insert_word(callback.get_word_div_visible());\r\n                }\r\n                if (code_holder === '') replace_selection(input_ctrl, '）', false);\r\n            } else {\r\n                if (callback.words_in_list() > 9) callback.insert_word(9);\r\n                else if (code_holder === '') replace_selection(input_ctrl, '０', false);\r\n            }\r\n            return return_false();\r\n        case 109:\r\n        case 189:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '＿' : 'ー', false);\r\n            else if (!e.shiftKey) alphabet_to_kana(input_ctrl, 'ー', show_hiragana);\r\n            return return_false();\r\n        case 107:\r\n        case 187:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '＋' : '＝', false);\r\n            return return_false();\r\n        case 81:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｑ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 87:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｗ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 69:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｅ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 82:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｒ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 84:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｔ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 89:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｙ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 85:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｕ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 73:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｉ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 79:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｏ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 80:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｐ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 219:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '｛' : '「', false);\r\n            return return_false();\r\n        case 221:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '｝' : '」', false);\r\n            return return_false();\r\n        case 220:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '｜' : '￥', false);\r\n            return return_false();\r\n        case 65:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ａ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 83:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｓ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 68:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｄ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 70:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｆ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 71:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｇ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 72:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｈ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 74:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｊ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 75:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｋ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 76:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｌ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 59:\r\n        case 186:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '：' : '；', false);\r\n            return return_false();\r\n        case 222:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') {\r\n                if (e.shiftKey) {\r\n                   left_yinhao2 = !left_yinhao2;\r\n                   replace_selection(input_ctrl, left_yinhao2 ? '“' : '”', false);\r\n                }\r\n                else {\r\n                   left_yinhao1 = !left_yinhao1;\r\n                   replace_selection(input_ctrl, left_yinhao1 ? '‘' : '’', false);\r\n                }\r\n            }\r\n            return return_false();\r\n        case 90:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｚ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 88:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｘ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 67:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｃ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 86:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｖ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 66:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｂ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 78:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｎ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 77:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (!callback.is_word_div_visible()) {\r\n                alphabet_to_kana(input_ctrl, 'ｍ', show_hiragana);\r\n            }\r\n            return return_false();\r\n        case 188:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '＜' : '、', false);\r\n            return return_false();\r\n        case 190:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '＞' : '。', false);\r\n            return return_false();\r\n        case 191:\r\n            if (callback.is_word_div_visible()) {\r\n                callback.insert_word(callback.get_word_div_visible());\r\n            }\r\n            if (code_holder === '') replace_selection(input_ctrl, e.shiftKey ? '？' : '・', false);\r\n            return return_false();\r\n        default:\r\n            return undefined;\r\n    }\r\n}\r\n\r\nfunction key_down(e, input_ctrl) {\r\n      // $('#show_area').html('');\r\n  //  $('.message').hide();\r\n   if (e.ctrlKey) return true;\r\n   var key = e.which ? e.which : e.keyCode;\r\n\r\n   var callback = input_ctrl.callback ?? new Callback(input_ctrl);\r\n   input_ctrl.callback = callback;\r\n   \r\n   if(e.key === '`' && e.ctrlKey) {  // ` + Ctrl -> Hiragana/Katakana\r\n      callback.show_hiragana = !callback.show_hiragana;\r\n      return true;\r\n   }\r\n   if(e.key === '-') // onbiki\r\n      key = 189;\r\n\r\n   if(e.key === '`') // quotes\r\n      key = 220;\r\n   \r\n   return key_down_japanese(e, key, input_ctrl, callback)\r\n}\r\n\r\nexport {key_down}","import React from 'react'\r\nimport $ from 'jquery';\r\nimport {key_down as key_down_korean} from './KoreanVK';\r\nimport {key_down as key_down_japanese} from './JapaneseVK';\r\n\r\n\r\nclass VirtualKeyboardInput extends React.Component {\r\n   constructor(props) {\r\n      super(props);\r\n      this.inputDiv = React.createRef();\r\n   }\r\n   \r\n   componentDidMount() {\r\n     this.vkEdit = new VirtuakKeyboardEdit({\r\n        input: this.inputDiv.current,\r\n        input_text: this.props.input_text,\r\n        ethalon: this.props.ethalon,\r\n        onChange: this.props.onChange,\r\n        language: this.props.language,\r\n     });\r\n     this.inputDiv.current.focus();\r\n  }\r\n\r\n   render() {\r\n      const styles = { minWidth: '6em', display: 'inline-block' };\r\n      return (\r\n         <span  style={styles} className=\"border border-primary\"\r\n               contentEditable=\"true\" \r\n               ref={this.inputDiv}\r\n               >\r\n         </span>\r\n      );\r\n   }\r\n}\r\n\r\nclass VirtuakKeyboardEdit {\r\n   constructor(props){\r\n      this.input = $(props.input);\r\n      this.handleKeyDown = this.handleKeyDown.bind(this);\r\n      this.handleMouseDown = this.handleMouseDown.bind(this);\r\n      this.handleOnInput = this.handleOnInput.bind(this);\r\n      $(this.input).keydown(this.handleKeyDown);\r\n      $(this.input).mousedown(this.handleMouseDown);\r\n      $(this.input).on(\"input\", this.handleOnInput);\r\n      $(this.input).text(props.input_text || '');\r\n      //$(this.input).html('Te<span class=\"bg-secondary\">ee</span>st of input');\r\n      this.ethalon = props.ethalon || '';\r\n      this.activeNode = null;\r\n      this.afterNode = null;\r\n      this.onChange = props.onChange || ((text) => {});\r\n      switch(props.language) {\r\n      case 'ko': this.key_down_handler = key_down_korean;\r\n         break;\r\n      case 'ja': this.key_down_handler = key_down_japanese;\r\n         break;\r\n      default:\r\n         this.key_down_handler = key_down_native;\r\n      }\r\n   }\r\n   \r\n   // full key code list\r\n   // http://gcctech.org/csc/javascript/javascript_keycodes.htm\r\n   handleKeyDown(e) {\r\n      var key = e.which ? e.which : e.keyCode;\r\n      $(\"#hint\").remove();\r\n      if(key === 32 && e.ctrlKey) {\r\n         this.show_hint();\r\n      }\r\n      const inEdit = this.activeNode != null;\r\n      const ret_value = this.key_down_handler(e, this);\r\n      if (key === 13) {\r\n         if(!inEdit)\r\n            this.input.blur();\r\n         return true;  // enter\r\n      }\r\n      if (this.activeNode == null) {\r\n         //this.remove_empty_elements(); // can lose focus!\r\n      }\r\n      return ret_value;\r\n   }\r\n   \r\n   handleMouseDown(e) {\r\n   }\r\n   \r\n   handleOnInput() {\r\n      const text = $(this.input).text();\r\n      this.onChange(text);\r\n   }\r\n\r\n   handleMouseDownDiv(e) {\r\n     if ((!document.all && e.button === 0) || (document.all && e.button === 1)) {\r\n        this.release_selection();\r\n     }\r\n   }\r\n   \r\n   getActiveNodeAndOffset() { \r\n     if (window.getSelection) {\r\n        const sel = window.getSelection();\r\n        return [sel.focusNode, sel.focusOffset];\r\n     }\r\n     return [null, 0]\r\n   }\r\n   \r\n   setActiveNodeCaretPos(newPos) { setCaretPosition(this.activeNode, newPos); }\r\n   \r\n   get_text_before(stopElem) {\r\n      let text = '';\r\n      $(this.input).contents().each((index, elem) => {\r\n         text += elem.textContent;\r\n         if(elem === stopElem)\r\n            return false;\r\n      });\r\n      return text;\r\n   }\r\n   \r\n   remove_empty_elements() {\r\n      $(this.input).children().each(function() {\r\n          if ($(this).text().length === 0) {\r\n              $(this).remove();\r\n          }\r\n      });\r\n   }\r\n   \r\n   get_text_before_caret() {\r\n      const [focusedNode, textOffset] = this.getActiveNodeAndOffset();\r\n      let text_before_caret = $(this.activeNode).text().substr(textOffset);\r\n      text_before_caret += this.get_text_before(focusedNode);\r\n      return text_before_caret;\r\n   }\r\n   \r\n   show_hint() {\r\n      if(this.ethalon === '')\r\n         return;\r\n       const text_before = this.get_text_before_caret();\r\n       let hint = this.ethalon.substr(text_before.length, 2);\r\n       //if (hint != '') {\r\n       hint = hint !== '' ? hint : '\\u20E0'; // no symbol\r\n       {\r\n          const hintElem = $('<span id=\"hint\" class=\"text-info\">').text(hint);\r\n          const [focusedNode, ] = this.getActiveNodeAndOffset();\r\n          this.append_elem_after_caret(focusedNode, hintElem);\r\n       }\r\n   }\r\n   \r\n   finish_input(str, after_elem) {\r\n      const full_text = this.get_text_before(after_elem);\r\n      const correct_text = this.ethalon.substr(full_text.length, str.length);\r\n      const isCorrect = (this.ethalon === '') || (correct_text === str);\r\n      let newNode = null;\r\n      if (isCorrect) {\r\n         newNode = document.createTextNode(str); // TODO: merge text nodes\r\n      } else {\r\n         newNode = $('<span class=\"text-danger\">').text(str);\r\n      }\r\n\r\n      if (after_elem === this.input[0])\r\n         $(after_elem).append(newNode);\r\n      else\r\n         $(after_elem).after(newNode);\r\n\r\n      if(this.afterNode != null)\r\n         setCaretPosition(this.afterNode, 0);\r\n      else if (newNode.nodeType === Node.TEXT_NODE)\r\n         setCaretPosition(newNode, str.length);\r\n      else\r\n         setCaretPosition(newNode[0].firstChild, str.length);\r\n      this.onChange(this.get_input_text());\r\n   }\r\n   \r\n   append_elem_after_caret(after_node, new_elem) {\r\n      if (after_node === this.input[0]) {\r\n         $(after_node).append(new_elem);  // the input is empty\r\n         return after_node;\r\n      }\r\n      else if (after_node.parentNode !== null && \r\n               after_node.parentNode !== this.input[0]) {\r\n         $(after_node.parentNode).after(new_elem);   // #TEXT of a child of the input\r\n         return after_node.parentNode;\r\n      } else\r\n         $(after_node).after(new_elem);   // #TEXT of the input\r\n      return after_node;\r\n   }\r\n   \r\n   get_input_text() {\r\n      //let textAndCorrectness = [];\r\n      let text = '';\r\n      $(this.input).contents().each((index, node) => {\r\n         //textAndCorrectness.push( [node.textContent, incorrect]);\r\n         text += node.textContent;\r\n      });\r\n      return text;\r\n   }\r\n   \r\n   // pressed Esc\r\n   clear_all() {\r\n      console.log('CLR ');\r\n      if(this.activeNode == null)\r\n         return;\r\n      $(\"#highlighted\").remove();\r\n      if (this.activeNode.nodeValue != null)\r\n         this.setActiveNodeCaretPos(this.activeNode.nodeValue.length);\r\n      this.activeNode = null;\r\n      this.afterNode = null\r\n   }\r\n\r\n   release_selection() {\r\n      console.log('Rel Sel');\r\n      if(this.activeNode == null)\r\n         return;\r\n      const added_text = $(\"#highlighted\").text();\r\n      $(\"#highlighted\").remove();\r\n      this.finish_input(added_text, this.activeNode);\r\n      this.activeNode = null;\r\n      this.afterNode = null;\r\n      \r\n\r\n   }\r\n   \r\n   replace_selection(str, highlight) {\r\n      console.log('RS:' + str + ' ' + highlight);\r\n      if(!highlight) {\r\n         if(this.activeNode == null) {\r\n            const [focusedNode, ] = this.getActiveNodeAndOffset(); // instant input\r\n            this.finish_input(str, focusedNode);\r\n            return;\r\n         }\r\n         $(\"#highlighted\").remove();\r\n         this.finish_input(str, this.activeNode);\r\n         this.activeNode = null;\r\n      }\r\n      else if(this.activeNode == null){\r\n         const [focusedNode, textOffset] = this.getActiveNodeAndOffset();\r\n         this.activeNode = focusedNode;\r\n         const initialText = $(this.activeNode).text();\r\n         this.activeNode.nodeValue = initialText.substr(0, textOffset);\r\n         const newSpan = $('<span id=\"highlighted\" class=\"text-white bg-dark\">').text(str);\r\n         if (this.activeNode === this.input[0])\r\n            $(this.activeNode).append(newSpan);  // the input is empty\r\n         else if (this.activeNode.parentNode !== null && \r\n                  this.activeNode.parentNode !== this.input[0]) {\r\n            this.activeNode = this.activeNode.parentNode;  // #TEXT of a child of the input\r\n            $(this.activeNode).after(newSpan);\r\n         } else\r\n            $(this.activeNode).after(newSpan);   // #TEXT of the input\r\n         const after_text = initialText.substr(textOffset);\r\n         if(after_text !== '') {\r\n            this.afterNode = document.createTextNode(after_text);\r\n            $(newSpan).after(this.afterNode);\r\n         } else \r\n            this.afterNode = null;\r\n         newSpan.focus(); // is this needed??\r\n         setCaretPosition(newSpan[0].firstChild ?? newSpan[0], 0);\r\n      }\r\n      else {\r\n         this.selected_text = str;\r\n         $(\"#highlighted\").text(str);\r\n      }\r\n   }\r\n}\r\n\r\nfunction key_down_native(e, input) {\r\n   if (e.key.length !== 1) {\r\n       return true;\r\n   }\r\n   input.replace_selection(e.key, false);\r\n   return false;\r\n}\r\n\r\nfunction setCaretPosition(elem, caretPos) {\r\n   var range = document.createRange();\r\n   var sel = window.getSelection();\r\n   range.setStart(elem, caretPos);\r\n   range.collapse(true);\r\n   sel.removeAllRanges();\r\n   sel.addRange(range);\r\n}\r\n\r\nexport default VirtualKeyboardInput;\r\n","import React, { useState, useEffect } from \"react\";\r\nimport { getUser, getTest } from './User.js';\r\nimport queryString from 'query-string';\r\nimport Editable from \"./Editable\";\r\nimport VirtualKeyboardInput from \"./VirtualKeyboardInput\";\r\nimport Pencil from \"bootstrap-icons/icons/pencil.svg\";\r\n\r\nfunction InputEditable({ethalon, onChange=((text) => {}), language}) {\r\n   const [typedText, setTypedText] = useState(\"\");\r\n  /*\r\n    Enclose the input element as the children to the Editable component to make it as inline editable.\r\n  */\r\n  return (\r\n    <Editable\r\n      text={typedText}\r\n      placeholder=\"Ввести слово\"\r\n      type=\"input\"\r\n    >\r\n      <VirtualKeyboardInput\r\n        name=\"typed_text\"\r\n        placeholder=''\r\n        input_text={typedText}\r\n        ethalon={ethalon}\r\n        onChange={text => { setTypedText(text); onChange(text);}}\r\n        language={language}\r\n      />\r\n    </Editable>\r\n  );\r\n}\r\n\r\nconst Mode = Object.freeze({\r\n      ShowWordAndTranslation: 1,\r\n      TestTranslation: 2,\r\n      TestWord: 3\r\n   })\r\n   \r\nfunction ConfirmTranslationControls({wordId}) {\r\n   const Step = Object.freeze({\r\n         ShowOkFailed: 1,\r\n         Ok: 2,\r\n         Failed: 3\r\n      })\r\n   const [step, setStep] = useState(Step.ShowOkFailed);\r\n   switch(step) {\r\n      case Step.ShowOkFailed:\r\n         return <React.Fragment>\r\n                  <span className=\"float-right\">\r\n                     <button className=' ml-2 btn btn-success btn-sm py-0' id={'remember-button-' + wordId}\r\n                             onClick={()=> { setStep(Step.Ok); getTest().setTranslationTestResult(wordId, true); }} >\r\n                        Помню\r\n                     </button>\r\n                     <button className=' ml-2 btn btn-danger btn-sm mx-1 py-0' id={'forgot-button-' + wordId}\r\n                             onClick={()=> { setStep(Step.Failed); getTest().setTranslationTestResult(wordId, false); }} >\r\n                        Не помню\r\n                     </button>\r\n                  </span>\r\n                </React.Fragment>\r\n      case Step.Ok:\r\n         return <span className=\"text-success float-right ml-2\">{'\\u00A0'.repeat(7)  + '\\u2713' + '\\u00A0'.repeat(27)}</span>\r\n      case Step.Failed:\r\n         return <span className=\"text-danger float-right ml-2\">{ '\\u00A0'.repeat(25) + '\\u2717' + '\\u00A0'.repeat(9)}</span>\r\n      default:\r\n         return null;\r\n   }\r\n}\r\n\r\nfunction getWordToShow(isKanaMode, item) {\r\n   return isKanaMode && item.extra !== undefined ? item.extra : item.word;\r\n}\r\n\r\nfunction ShowBothMode({rows, modeControls, isFirst, isKanaMode}) {\r\n   isFirst = false;\r\n   const rowElements = rows.map(\r\n                  (item, index) => {\r\n                     const wordToShow = getWordToShow(isKanaMode, item);\r\n                     if(index === 0) {\r\n                        return (<tr key={index} >\r\n                                    <td rowSpan={rows.length} >\r\n                                      {modeControls}\r\n                                    </td>\r\n                                    <td className={isFirst ? \"\" : \"\"}>{wordToShow}</td>\r\n                                    <td>{item.meaning}</td>\r\n                               </tr>)\r\n                     } else {\r\n                     return (<tr key={index}>\r\n                                 <td>{wordToShow}</td>\r\n                                 <td>{item.meaning}</td>\r\n                            </tr>)\r\n                     }\r\n                  });\r\n   return rowElements;\r\n}\r\n\r\nfunction getBgColorFromScore(score) {\r\n   switch(score) {\r\n      // better 98c9a3  best  77bfa3\r\n      case 3: return \"#bfd8bd80\";\r\n      case 2: return \"#dde7c780\";\r\n      case 1:\r\n      case 0: return 0;\r\n\r\n      case -1: return \"#ffdab980\";\r\n      case -2: return \"#fbc4ab80\";\r\n      case -3: \r\n      case -4: return \"#f8ad9d80\";\r\n      default:\r\n         return (score > 0) ? \"#98c9a380\" : \"#f4978e80\";\r\n   }\r\n}\r\n\r\nfunction TestTranslationMode({rows, modeControls, isFirst, isKanaMode}) {\r\n   const [isTranslationShown, showTranslation] = useState(false);\r\n\r\n   const TranslationCell = ({translation, wordId}) => {\r\n                              return (<td>{isTranslationShown\r\n                                       ? (<React.Fragment>\r\n                                             <span>{translation}</span> \r\n                                             <ConfirmTranslationControls key={wordId} wordId={wordId} />\r\n                                          </React.Fragment>\r\n                                          )\r\n                                       : '\\u00A0'.repeat(/*translation.length*/10)}\r\n                                 </td>)\r\n                           };\r\n   const buttonShow =  <button className={'btn btn-outline-info btn-sm mt-2 d-block '}\r\n                                 onClick={()=> {showTranslation(true)}} \r\n                                 disabled={isTranslationShown}>\r\n                              Показать перевод\r\n                       </button>;\r\n   const rowElements = rows.map(\r\n                  (item, index) => {\r\n                     const bgColor = getBgColorFromScore(item.score);\r\n                     const wordToShow = getWordToShow(isKanaMode, item);\r\n                     if(index === 0) {\r\n                        return (<tr key={index}>\r\n                                    <td rowSpan={rows.length}>{modeControls} {buttonShow}</td>\r\n                                    <td style={{ backgroundColor: bgColor}}>{wordToShow}</td>\r\n                                    <TranslationCell translation={item.meaning} wordId={item.id} />\r\n                              </tr>)\r\n                     } else {\r\n                        return (<tr key={index}>\r\n                                  <td style={{backgroundColor: bgColor}}>{wordToShow}</td>\r\n                                  <TranslationCell translation={item.meaning} wordId={item.id} />\r\n                               </tr>);\r\n                     }\r\n                  });\r\n   return rowElements;\r\n}\r\n\r\nfunction RowToInputWord({modeControls, rowSpan, word, translation, language}) {\r\n   const [isCorrect, setCorrect] = useState(false);\r\n   const onChangeText = (text) => {\r\n      const correct = (text.length !== 0) && (word === text);\r\n      setCorrect(correct);\r\n   };\r\n   const after = <div className='text-success float-right'>{isCorrect ? '\\u2713' : ''}</div>;\r\n   const editable = <div className=\"float-left\">\r\n                        <InputEditable \r\n                           ethalon={word} \r\n                           onChange={onChangeText}\r\n                           language={language}\r\n                        />\r\n                    </div>;\r\n   return  (<tr>\r\n               {modeControls ? (<td rowSpan={rowSpan}>{modeControls}</td>) : null}\r\n               <td>\r\n                  {editable}\r\n                  {after}\r\n               </td>\r\n               <td className=''>{translation}</td>\r\n            </tr>);\r\n}\r\n\r\nfunction TestWordMode({rows, modeControls, language, isKanaMode}) {\r\n   const rowElements = rows.map(\r\n         (item, index) => {\r\n            const wordToShow = getWordToShow(isKanaMode, item);\r\n            return <RowToInputWord word={wordToShow} \r\n                                 translation={item.meaning} \r\n                                 language={language}\r\n                                 modeControls={index === 0 ? modeControls : undefined}\r\n                                 rowSpan={rows.length}\r\n                                 key={index} />\r\n         });\r\n   return rowElements;\r\n}\r\n\r\nfunction Card({rows, language, name, isFirst, isActive, onActivate, isKanaMode,\r\n               initialMode, onResetMode}) {\r\n   const [mode, setMode] = useState(initialMode ?? Mode.TestTranslation);\r\n   //console.log(initialMode ?? Mode.TestTranslation);\r\n   if(initialMode != undefined && initialMode != mode) {\r\n      setMode(initialMode);\r\n   }\r\n\r\n   const ModeButton = ({buttonMode, name, title, id}) => {\r\n             const style = isActive ? 'primary' : 'secondary';\r\n             return <label className={`btn btn-sm btn-outline-${style} text-left ` + ((mode === buttonMode)? 'active' : '')}\r\n                        title={title}>\r\n                        <input type=\"radio\" name={\"option\"+id} id={\"option\"+id}\r\n                        autoComplete=\"off\" checked={mode === buttonMode}\r\n                        onChange={() => { onActivate(); setMode(buttonMode) }} />\r\n                        {name}\r\n                   </label>\r\n   };\r\n   const modeControls = (\r\n          <div className=\"btn-group-vertical btn-group-toggle p-0\" data-toggle=\"buttons\">\r\n            <ModeButton buttonMode={Mode.ShowWordAndTranslation} name=\"1. Слово и перевод\"   title='Показать слово и перевод' id=\"0\"/>\r\n            <ModeButton buttonMode={Mode.TestTranslation}        name=\"2. Проверить перевод\" title='Проверить перевод' id=\"1\"/>\r\n            <ModeButton buttonMode={Mode.TestWord}               name=\"3. Ввести слово\"      title='Проверит слово' id=\"2\"/>\r\n          </div>\r\n   );\r\n   let modeTable = null;\r\n   const args = {\r\n      rows: rows,\r\n      modeControls: modeControls,\r\n      isFirst: isFirst,\r\n      language: language,\r\n      isKanaMode: isKanaMode\r\n   };\r\n   switch(mode) {\r\n      case Mode.ShowWordAndTranslation:  modeTable = <ShowBothMode         {...args}/>; break;\r\n      case Mode.TestTranslation:         modeTable = <TestTranslationMode  {...args}/>; break;\r\n      case Mode.TestWord:                modeTable = <TestWordMode         {...args}/>; break;\r\n      default:\r\n   }\r\n\r\n   return (<tbody style={{ }} className={isActive ? \"border border-primary\" : \"\"}>{modeTable}</tbody>);\r\n}\r\n\r\n\r\n\r\nconst KanaMode = ({onChange}) => (\r\n    <div className=\"custom-control custom-checkbox mb-3\">\r\n      <input type=\"checkbox\" className=\"custom-control-input\" id=\"kanaModeCheck\" name=\"kanaMode\" onChange={(e) => onChange(e.target.checked)} />\r\n      <label className=\"custom-control-label\" htmlFor=\"kanaModeCheck\">Отображать слова каной (理解 → りかい)</label>\r\n    </div>\r\n);\r\n\r\nconst VirtualKbd = ({onChange}) => (\r\n    <div className=\"custom-control custom-checkbox mb-3\">\r\n      <input type=\"checkbox\" className=\"custom-control-input\" id=\"virtualKbdCheck\" name=\"virtualKbd\"\r\n             onChange={(e) => onChange(e.target.checked)} defaultChecked={true} />\r\n      <label className=\"custom-control-label\" htmlFor=\"virtualKbdCheck\">Виртуальная клавиатура</label>\r\n    </div>\r\n);\r\n\r\nconst OnlyForgotten = ({onChange}) => (\r\n    <div className=\"custom-control custom-checkbox mb-3\">\r\n      <input type=\"checkbox\" className=\"custom-control-input\" id=\"onlyForgotteCheck\" name=\"onlyForgotten\"\r\n             onChange={(e) => onChange(e.target.checked)} defaultChecked={false} />\r\n      <label className=\"custom-control-label\" htmlFor=\"onlyForgotteCheck\">Показывать только забытые слова</label>\r\n    </div>\r\n);\r\n\r\n// Create flag from country code\r\nfunction getCountryFlag(cc) {\r\n  // Mild sanity check.\r\n  if (cc.length !== 2)\r\n    return cc;\r\n\r\n  // Convert char to Regional Indicator Symbol Letter\r\n  function risl(chr) {\r\n    return String.fromCodePoint(0x1F1E6 - 65 + chr.toUpperCase().charCodeAt(0));\r\n  }\r\n\r\n  // Create RISL sequence from country code.\r\n  return risl(cc[0]) + risl(cc[1]);\r\n}\r\n\r\nconst Emoji = props => (\r\n    <option\r\n        className=\"emoji\"\r\n        role=\"img\"\r\n        aria-label={props.label ?? \"\"}\r\n        aria-hidden={props.label ? \"false\" : \"true\"}\r\n        value={props.label ?? \"\"}\r\n    >\r\n        {props.symbol}\r\n    </option>\r\n);\r\n\r\nconst LanguageSelector = ({language}) => (\r\n   <div className=\"form-group row\" >\r\n      <label htmlFor=\"language-select\" className=\"col-sm-1 col-form-label\" >Язык: </label>\r\n      <select  style={{width: \"10em\"}} className=\"form-control\" id=\"language-select\" value={language} onChange={()=>{}}>\r\n         <option value=\"\">Не указан</option>\r\n         <Emoji symbol={getCountryFlag('us') + ' Английский'} label=\"en\" />\r\n         <Emoji symbol={getCountryFlag('kr') + ' Корейский'}  label=\"ko\"  />\r\n         <Emoji symbol={getCountryFlag('jp') + ' Японский'}   label=\"ja\" />\r\n      </select>\r\n   </div>\r\n);\r\n\r\nconst SetAllCardMode = ({mode, onModeChange}) => {\r\n   return (\r\n         <div className=\"form-group row\">\r\n            <label className=\"col-sm-1 col-form-label\">Общий режим:</label>\r\n            { /*<div className=\"my-2 form-control\"> */ }\r\n               <button className='btn btn-outline-primary' \r\n                       disabled={mode == Mode.ShowWordAndTranslation}\r\n                       onClick={()=> onModeChange(Mode.ShowWordAndTranslation)} >\r\n                 1. Слово и перевод\r\n               </button>\r\n               <button className='btn btn-outline-primary ml-2' \r\n                       disabled={mode == Mode.TestTranslation}\r\n                       onClick={()=> onModeChange(Mode.TestTranslation)} >\r\n                 2. Проверить перевод\r\n               </button>\r\n               <button className='btn btn-outline-primary ml-2' \r\n                       disabled={mode == Mode.TestWord}\r\n                       onClick={()=> onModeChange(Mode.TestWord)} >\r\n                 3. Ввести слово\r\n               </button>\r\n           {  /*</div>*/ }\r\n           </div>);\r\n}\r\n\r\nfunction Matrix(props) {\r\n   const [deck, setDeck] = useState({rows:[], name: '', language: ''});\r\n   const [activeCardId, setActiveCardId] = useState(undefined);\r\n   const [isKanaMode, setKanaMode] = useState(false);\r\n   const [isVirtualKbd, setVirtualKbd] = useState(true);\r\n   const [isOnlyForgottenWords, setOnlyForgottenWords] = useState(false);\r\n   const [initialMode, setInitialMode] = useState(Mode.TestTranslation);\r\n   \r\n   useEffect(() => {\r\n      if(deck.name === ''){\r\n         deckGetter();\r\n      }\r\n   });\r\n   \r\n   const urlParams = queryString.parse(props.location.search);\r\n   if (urlParams.id === undefined) {\r\n      return null;\r\n   }\r\n\r\n   const deckId = urlParams.id;\r\n   const deckGetter = async () => {\r\n      const deckD = await getUser().getDeck(deckId, 0, 100);\r\n      setDeck(deckD);\r\n   }\r\n   \r\n   if (deck === undefined)\r\n      return null;\r\n\r\n   const chunk_size = 5;\r\n   \r\n   const cardRows = !isOnlyForgottenWords \r\n                        ? deck.rows \r\n                        : deck.rows.filter((item) => item.score < 0);\r\n\r\n   let cards = [];\r\n   for (let i=0, size = cardRows.length; i < size; i += chunk_size) {\r\n      const temparray = cardRows.slice(i, i + chunk_size);\r\n      const cardData = { \r\n                     rows: temparray, \r\n                     name : '' + (i + 1) + '-' + (i + temparray.length),\r\n                     language : deck.language,\r\n                     isFirst: i === 0,\r\n                     isActive: activeCardId === i,\r\n                     onActivate: () => { setActiveCardId(i); setInitialMode(undefined) },\r\n                     isKanaMode: isKanaMode,\r\n                     initialMode: initialMode,\r\n                  //   onResetMode: () => setInitialMode(undefined)\r\n                   };\r\n      cards.push(<Card key={i} {...cardData} />);\r\n   }\r\n\r\n   const tableStyle = \"table table-striped table-sm  table-nonfluid border\";\r\n   return ( <div className=\"m-2\">\r\n               <h2 className=\"ml-3\">{deck.name}</h2>\r\n               \r\n               <div className=\"col-form-label\" >{deck.description}</div>\r\n               <LanguageSelector language={deck.language} />\r\n               { (['ja', 'cn' ].indexOf(deck.language)>= 0) ? <KanaMode onChange={(isSet) => setKanaMode(isSet)}/> : null }\r\n               { (['ja', 'cn' ].indexOf(deck.language)>= 0) ? <VirtualKbd onChange={(isSet) => {} } /> : null } \r\n               <OnlyForgotten onChange={(isSet) => setOnlyForgottenWords(isSet)} />\r\n               <SetAllCardMode mode={initialMode}\r\n                               onModeChange={ (mode) => setInitialMode(mode) } />\r\n               <table className={tableStyle}>\r\n                  <thead className=\"thead-light\">\r\n                     <tr>\r\n                        <th >Режим повторения</th> \r\n                        <th style={{ minWidth: '10em'}} >Слово</th> \r\n                        <th >Перевод</th> \r\n                     </tr>\r\n                  </thead>\r\n                  {cards}\r\n               </table>\r\n           </div>);\r\n}\r\n\r\nexport { Matrix };","import React, { useState, useEffect } from 'react'\r\nimport {Modal, Button, Form} from 'react-bootstrap'\r\nimport { NavLink, useHistory } from 'react-router-dom'\r\nimport { getUser } from './User.js'\r\n\r\nconst UserControl = () => {\r\n   const [username, setUsername] = useState(undefined);\r\n   const history = useHistory();\r\n   \r\n   useEffect(() => {\r\n      userGetter();\r\n   });\r\n\r\n   const userGetter = async () => {\r\n      const username = await getUser().getName();\r\n      setUsername(username);\r\n   }\r\n   \r\n   const onLogout = () => {\r\n      getUser().logout();\r\n      setUsername(undefined);\r\n      history.push('/');\r\n   }\r\n   \r\n   return (username === undefined)\r\n            ? (\r\n               <span className=\"float-right text-center \">\r\n                  <Login />\r\n                  <Button variant=\"secondary ml-2\">Регистрация</Button>\r\n               </span>\r\n            )\r\n            : (\r\n               <span className=\"float-right\">\r\n                  <Button variant=\"link\">{username}</Button>\r\n                  <Button variant=\"secondary ml-1\" onClick={onLogout}>Выход</Button>\r\n               </span>\r\n            );\r\n}\r\n\r\nfunction Login() {\r\n  const [show, setShow] = useState(false);\r\n  const [username, setUsername] = useState();\r\n  const [password, setPassword] = useState();\r\n  const [rememberMe, setRememberMe] = useState(true);\r\n  //const history = useHistory();\r\n  \r\n   useEffect(() => {\r\n      if(username === undefined){\r\n         //deckGetter();\r\n      }\r\n   });\r\n\r\n  const handleClose = () => setShow(false);\r\n  const handleShow = () => setShow(true);\r\n  const login = () => {\r\n     getUser().login(username, password, rememberMe).then(() => {\r\n        setUsername(username);\r\n        //history.push('/');\r\n     });\r\n  }\r\n\r\n  return (\r\n    <>\r\n      <Button variant=\"primary\" onClick={handleShow}>\r\n        Вход\r\n      </Button>\r\n\r\n      <Modal show={show} onHide={handleClose}>\r\n        <Modal.Header closeButton>\r\n          <Modal.Title>Вход в систему</Modal.Title>\r\n        </Modal.Header>\r\n        <Modal.Body>\r\n         <Form>\r\n           <Form.Group controlId=\"formBasicName\">\r\n             <Form.Control type=\"input\" placeholder=\"Имя\" onChange={ (e) => setUsername(e.target.value) } />\r\n           </Form.Group>\r\n\r\n           <Form.Group controlId=\"formBasicPassword\">\r\n             <Form.Control type=\"password\" placeholder=\"Пароль\" onChange={ (e) => setPassword(e.target.value) } />\r\n           </Form.Group>\r\n           <Form.Group controlId=\"formBasicCheckbox\">\r\n             <Form.Check type=\"checkbox\" label=\"Запомнить\" onChange={(e) => setRememberMe(e.target.checked)} />\r\n           </Form.Group>\r\n         </Form>\r\n        </Modal.Body>\r\n        <Modal.Footer>\r\n          <Button variant=\"primary\" onClick={ () => { handleClose(); login(); } }>\r\n            Вход\r\n          </Button>\r\n          <Button variant=\"secondary\" onClick={handleClose}>\r\n            Отмена\r\n          </Button>\r\n        </Modal.Footer>\r\n      </Modal>\r\n    </>\r\n  );\r\n}\r\n\r\nclass NavBar extends React.Component {\r\n   render() {\r\n      return (\r\n         <header>\r\n            <nav className='p-1 bg-dark'>\r\n               <img className=' m-2' src='/mind_icon_src.png' alt='logo' width='32' height='32' />\r\n               <NavLink to='/' className=' ml-2'>Все списки</NavLink>\r\n               <NavLink to='/test' className=' ml-3'>Тест-страница</NavLink>\r\n               <NavLink to='/about' className=' ml-3'>О программе</NavLink>\r\n               <UserControl />\r\n            </nav>\r\n         </header>\r\n      );\r\n   }\r\n}\r\n\r\nexport { NavBar };","import React from 'react';\r\nimport VirtualKeyboardInput from './VirtualKeyboardInput.js' \r\n\r\nconst InputTest = () => {\r\n   return (\r\n      <div className='m-1'>\r\n        <div>\r\n           <VirtualKeyboardInput/>\r\n        </div>\r\n        <div>\r\n           <VirtualKeyboardInput\r\n             placeholder=''\r\n             input_text=''\r\n             language='ko' />\r\n        </div>\r\n        <div>\r\n           <VirtualKeyboardInput\r\n             placeholder=''\r\n             input_text=''\r\n             language='ja' />\r\n        </div>\r\n     </div>);\r\n}\r\n\r\nconst TestPage = (props) => {\r\n   return <InputTest />;\r\n}\r\n\r\nexport {TestPage};","import React from 'react';\nimport { BrowserRouter, Route, Switch } from 'react-router-dom';\nimport './App.css';\nimport { MatrixList } from './MatrixList.js'\nimport { Matrix } from './Matrix.js'\nimport { NavBar } from './NavBar.js'\nimport { TestPage } from './TestPage.js'\n\nfunction Error() {\n   return (\n            <div className='text-center'>\n               <h1>404</h1>\n               <h2>Нет такой страницы</h2>\n            </div>\n          );\n}\n\nfunction App() {\n  return (\n      <BrowserRouter>\n         <NavBar />\n            <Switch>\n             <Route path=\"/\" component={MatrixList} exact/>\n             <Route path=\"/matrix\" component={Matrix}/>\n             <Route path=\"/test\" component={TestPage}/>\n             <Route component={Error}/>\n           </Switch>\n      </BrowserRouter>\n  );\n}\n\nexport default App;\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.0/8 are considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl, {\n    headers: { 'Service-Worker': 'script' },\n  })\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready\n      .then(registration => {\n        registration.unregister();\n      })\n      .catch(error => {\n        console.error(error.message);\n      });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport 'bootstrap/dist/css/bootstrap.css';\nimport App from './App';\nimport * as serviceWorker from './serviceWorker';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n"],"sourceRoot":""}